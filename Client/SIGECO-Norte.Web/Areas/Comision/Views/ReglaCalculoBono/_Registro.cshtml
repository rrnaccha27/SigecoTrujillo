@model SIGEES.Entidades.regla_calculo_bono_dto
@{
    int? codigo_tipo_planilla = Model.codigo_regla_calculo_bono != -1 ? Model.codigo_tipo_planilla : (int?)null;
    int? codigo_canal = Model.codigo_regla_calculo_bono != -1 ? Model.codigo_canal: (int?)null;
    int? codigo_grupo = Model.codigo_regla_calculo_bono != -1 ? Model.codigo_grupo: (int?)null;
    string vigencia_inicio = Model.codigo_regla_calculo_bono != -1 ? Model.vigencia_inicio.Substring(6, 2) + '/' + Model.vigencia_inicio.Substring(4, 2) + '/' + Model.vigencia_inicio.Substring(0, 4) : "";
    string vigencia_fin = Model.codigo_regla_calculo_bono != -1 ? Model.vigencia_fin.Substring(6, 2) + '/' + Model.vigencia_fin.Substring(4, 2) + '/' + Model.vigencia_fin.Substring(0, 4) : "";
}



<div class="easyui-layout" data-options="fit:true">
    <form id="frmRegistro" method="post">
        <div data-options="region:'north', border:false" style="padding:10px 10px 0px 10px;height:200px;">
            <div class="easyui-layout" data-options="fit:true">
                <div class="easyui-panel" title="Datos Generales" style="width: 100%;">
                    <table style="width:99%">
                        <tr>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Tipo</label>
                            </td>
                            <td class="tdValor">
                                <input class="easyui-combobox" id="cmb_tipo_planilla" name="cmb_tipo_planilla" value="@codigo_tipo_planilla" style="width: 85%" data-options="required:true, editable:false" />
                            </td>
                            <td class="tdEtiqueta"><label class="colGridModal">Calcular IGV</label></td>
                            <td class="tdValor"><input class="easyui-switchbutton" id="calcular_igv"  data-options="onText:'Si', offText:'No', required:true" /></td>
                        </tr>
                        <tr>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Canal</label>
                            </td>
                            <td class="tdValor">
                                <input class="easyui-combobox" id="codigo_canal" name="codigo_canal" value="@codigo_canal" style="width: 85%" data-options="required:true, editable:false" />
                            </td>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Grupo</label>
                            </td>
                            <td class="tdValor">
                                <input class="easyui-combobox" id="codigo_grupo" name="codigo_grupo" value="" style="width: 85%" data-options="editable:false" />
                            </td>
                        </tr>
                        <tr>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Vigencia</label>
                            </td>
                            <td class="tdValor">
                                <input class="easyui-datebox" id="fechaInicio" name="fechaInicio" value="@vigencia_inicio" style="width:85%;" data-options="required:true" />
                            </td>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Hasta</label>
                            </td>
                            <td class="tdValor">
                                <input class="easyui-datebox" id="fechaFin" name="fechaFin" value="@vigencia_fin" style="width:85%;" data-options="required:true" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="easyui-panel" title="Configuración Global" style="width: 100%;">
                    <table style="width:99%">
                        <tr>
                            <td class="tdEtiqueta">
                                <label class="colGridModal">Al 100%</label>
                            </td>
                            <td class="tdValor">
                                Meta&nbsp;<input class="easyui-numberbox" id="monto_meta_100" name="monto_meta_100" value="@Model.monto_meta" style="width: 30%" data-options="required:true, min:0,max:9999999, precision:2" />
                            </td>
                            <td class="tdValor">
                                Porcentaje a pagar&nbsp;<input class="easyui-numberbox" id="porcentaje_pago_100" name="porcentaje_pago_100" value="@Model.porcentaje_pago" style="width: 30%" data-options="required:true, min:0,max:100, precision:2" />
                            </td>
                            <td class="tdValor">
                                Tope Global&nbsp;<input class="easyui-numberbox" id="monto_tope_100" name="monto_tope_100" value="@Model.monto_tope" style="width: 40%" data-options="required:true, min:0,max:9999999, precision:2" />
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

        </div>
        <div data-options="region:'center', border:false" style="padding:0px 10px 10px 10px;height:100%">

            <div class="easyui-tabs" style="width:100%; height:100%">
                <div title="Montos" style="padding:5px;">
                    <div id="tbMonto">
                        <a href="javascript:NuevoRegistro()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-add'">Asignar</a>
                        <a href="javascript:EliminarRegistro()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-remove'">Quitar</a>
                        <a href="javascript:AceptarRegistro()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-save'">Aceptar</a>
                        <a href="javascript:CancelarRegistro()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-cancel'">Cancelar</a>
                    </div>
                    <table id="dgMontos" style="width: 100%; height:100%"></table>
                </div>
                <div title="Artículos" style="padding:5px;">
                    <div id="tbArticulos">
                        <table style="width:99%">
                            <tr>
                                <td class="tdArticulo">
                                    <label class="colGridModal">Artículo</label>&nbsp;
                                    <a href="javascript:BuscarArticulo();" class="easyui-linkbutton" id="btnBuscarPersona" name="btnBuscarPersona" iconcls="icon-search"></a> <input class="easyui-textbox" id="nombre_articulo" name="nombre_articulo" style="width:70%;" readonly>
                                </td>
                                <td class="tdEtiqueta">
                                    <label class="colGridModal">Cantidad</label>&nbsp;
                                    <input class="easyui-numberbox" id="cantidad_articulo" name="cantidad_articulo" value="0" style="width: 40%" data-options="min:0,max:100, precision:0" />
                                </td>
                                <td class="tdValor">
                                    <div style="text-align:right">
                                        <a href="javascript:AgregarArticulo();" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-add'">Agregar</a>
                                        <a href="javascript:QuitarArticulo();" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " data-options="iconCls:'icon-remove'">Quitar</a>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <table id="dgArticulos" style="height: 100%;"></table>
                </div>
                <div title="Ventas" style="padding:10px;">
                    <div class="panelGridModal">
                        <table style="width:99%">
                            <tr>
                                <td class="tdEtiqueta">
                                    <label class="colGridModal">Cantidad Ventas</label>
                                </td>
                                <td class="tdValor">
                                    <input class="easyui-numberbox" id="cantidad_ventas" name="cantidad_ventas" value="@Model.cantidad_ventas" style="width: 85%" data-options="min:0,max:100, precision:0" />
                                </td>
                                <td class="tdEtiqueta"></td>
                                <td class="tdValor"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

        </div>

        <div data-options="region:'south', border:false" style="padding:0px;">
            <div id="divRegistroBotones" style="width: 100%; height: 100%; display: inline-block; text-align:right;">
                <a href="javascript:GuardarRegla()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " iconcls="icon-ok" id="btnGuardar">Guardar</a>
                <a href="javascript:Cancelar()" class="easyui-linkbutton" style="padding: 0px 10px 0px 10px; " iconcls="icon-cancel" id="btnCancelar">Cancelar</a>
            </div>
        </div>
    </form>
</div>
@Html.Partial("_BusquedaArticulo")
<style>
    .tdEtiqueta {
        width: 20%;
        padding: 5px;
    }

    .tdValor {
        width: 30%;
    }
    .tdArticulo {
        width: 45%;
    }

</style>

<script type="text/javascript" src="~/Areas/Comision/Scripts/Views/ReglaCalculoBono/project.ReglaCalculoBono.Registro.js"></script>
<script>

    $(document).ready(function () {
        var registroUrls =
        {
            GetTipoPlanillaJson: '@Url.Action("GetTipoPlanillaJson", "ReglaCalculoBono", new { area = "comision" })',
            GetCanalGrupoJson: '@Url.Action("GetCanalGrupoJson", "ReglaCalculoBono", new { area = "comision" })',
            GetArticulosBusquedaJson: '@Url.Action("GetArticulosBusquedaJson", "ReglaCalculoBono", new { area = "comision" })',
            GetArticulosJson: '@Url.Action("GetArticulosJson", "ReglaCalculoBono", new { area = "comision" })',
            GetMatrizJson: '@Url.Action("GetMatrizJson", "ReglaCalculoBono", new { area = "comision" })',
            Guardar: '@Url.Action("Guardar", "ReglaCalculoBono", new { area = "comision" })',
            codigo_regla_calculo_bono: '@Model.codigo_regla_calculo_bono',
            estado_registro: '@Model.estado_registro',
            _codigo_grupo: '@codigo_grupo',
            _codigo_canal: '@codigo_canal'
        };

        project.ReglaCalculoBonoRegistro.Initialize(registroUrls);
    });


</script>

